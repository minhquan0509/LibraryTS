<%- include('partials/header'); -%>

<p><%=loginUser.emailLogin%></p>
<p><%=loginUser.isAdminLogin%></p>



<% if (loginUser.isAdminLogin == false) { %>

  <div class="content container">
    
    <h1>My Information</h1>
    <button
    type="button"
    class="btn btn-primary"
    data-toggle="modal"
    data-target="#changePassword"
  >
    <i class="fa-solid fa-plus"></i> Change password
  </button>


  <!-- Modal -->
  <div
    class="modal fade"
    id="changePassword"
    tabindex="-1"
    role="dialog"
    aria-labelledby="exampleModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header border-bottom-0">
          <h5 class="modal-title" id="exampleModalLabel">Change password</h5>
          <button
            type="button"
            class="close"
            data-dismiss="modal"
            aria-label="Close"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <form action="/user/change-password" method="post">
          <div class="modal-body">
             
            
            <div class="form-group">
              <input
                type="text"
                class="form-control"
                id=""
                value="<%=loginUser.emailLogin%>"
                name="email"
                hidden
              />
            </div>

            <div class="form-group"> 
              <label for="">Enter Your Current Password</label>
              <input
                type="password"
                class="form-control"
                id=""
                placeholder="Enter Your Current Password"
                name="currentPassword"
              />
            </div>

            <div class="form-group">
              <label for="">Enter Your New Password</label>
              <input
                type="password"
                class="form-control"
                id=""
                placeholder="Enter Your New Password"
                name="newPassword"
              />
            </div>

            <div class="form-group">
              <label for="">Enter Your New Password Again</label>
              <input
                type="password"
                class="form-control"
                id=""
                placeholder="Enter Your New Password Again"
                name="newPasswordAgain"
              />
            </div>
            
            
          </div>
          <div class="modal-footer border-top-0 d-flex justify-content-center">
            <button type="submit" class="btn btn-success">Commit Change</button>
          </div>
        </form>
      </div>
    </div>
  </div>



    <table
      class="table table-striped table-hover"
      data-toggle="table"
      data-search="true"
    >
      <caption>
        You can change your Information by double clicking in the text
      </caption>
      <thead class="thead-dark">
        <tr>
          <th scope="col">User Email</th>
          <th scope="col">First Name</th>
          <th scope="col">Last Name</th>
          <th scope="col">Address</th>
          <th scope="col">Phone Number</th>
          <th scope="col">Is Administration</th>
          <th scope="col">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% userData.forEach((userData)=>{ %> <%let isAdminOrNot= userData.isAdmin
        || false; %>
        <p>
          <%isAdminOrNot=(!isAdminOrNot)||(userData.email==loginUser.emailLogin);%>
        </p>
        <tr>
          <td
            class="edit"
            contenteditable="false"
            id="userEmail_<%= userData.email %>"
          >
            <%= userData.email %>
          </td>
          <td
            class="edit"
            contenteditable="<%=isAdminOrNot%>"
            id="userFirstName_<%= userData.email %>"
          >
            <%= userData.firstName %>
          </td>
          <td
            class="edit"
            contenteditable="<%=isAdminOrNot%>"
            id="userLastName_<%= userData.email %>"
          >
            <%= userData.lastName %>
          </td>
          <td
            class="edit"
            contenteditable="<%=isAdminOrNot%>"
            id="userAddress_<%= userData.email %>"
          >
            <%= userData.address %>
          </td>
          <td
            class="edit"
            contenteditable="<%=isAdminOrNot%>"
            id="userPhoneNumber_<%= userData.email %>"
          >
            <%= userData.phoneNumber %>
          </td>
  
          
  
          <td
            class="edit"
            contenteditable="false"
            id="userIsAdmin_<%= userData.email %>"
          >
            <%= userData.isAdmin %>
          </td>
          <td>
            <% if (isAdminOrNot) { %>
            <button
              class="btn btn-success btn-save"
              id="saveBtn_<%=userData.email%>"
            >
              Edit
            </button>
  
            <% } %>
          </td>
        </tr>
        <%}); %>
      </tbody>
    </table>
    </div>
    
    
  <script src="/js/editUser.js"></script>
  <% } %>

  <script
  src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
  integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
  crossorigin="anonymous"
></script>
<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
  integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
  crossorigin="anonymous"
></script>

<%- include('partials/footer'); -%>