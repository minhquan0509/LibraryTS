<%- include('partials/header'); -%>

<!-- <p><%=loginUser.emailLogin%></p>
<p><%=loginUser.isAdminLogin%></p> -->
<% if (loginUser.isAdminLogin == false) { %>
<div class="content container">
  <h1>My Information</h1>

  <% userData.forEach((userData)=>{ %> <%let isAdminOrNot= userData.isAdmin|| false; %>

  <p>
    <%isAdminOrNot=(!isAdminOrNot)||(userData.email==loginUser.emailLogin);%>
  </p>

  <div class="container-xl px-4 mt-4">

    <hr class="mt-0 mb-4">
    <div class="row">
      <div class="col-xl-4">
        <!-- Profile picture card-->
        <div class="card mb-4 mb-xl-0">
          <div class="card-header">Profile Picture</div>
          <div class="card-body text-center">
            <!-- Profile picture image-->
            <img class="img-account-profile rounded-circle mb-2" src="../public/images/userImages/<%= userData.avatar %>" alt="">
            <!-- Profile picture help block-->
            <div class="small font-italic text-muted mb-4">JPG or PNG no larger than 5 MB</div>
            <button type="button" class="btn btn-info" data-toggle="modal" data-target="#changeAvatar">
              <i class="fa-solid "></i> Change Avatar
            </button>


            <div class="modal fade" id="changeAvatar" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
              aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                  <div class="modal-header border-bottom-0">
                    <h5 class="modal-title" id="exampleModalLabel">Change Avatar</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <form action="/user/change-avatar" enctype="multipart/form-data" method="post">
                    <div class="modal-body">
                      <div class="form-group">
                        <input type="text" class="form-control" id="" value="<%=loginUser.emailLogin%>" name="email"
                          hidden />
                      </div>

                      <div class="form-group">
                        <label for="">Choose image</label>
                        <input type="file" class="form-control" id="" name="avatar" accept='image/*' required />
                      </div>

                    </div>
                    <div class="modal-footer border-top-0 d-flex justify-content-center">
                      <button type="submit" class="btn btn-success">Change</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>

            <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#changePassword">
              <i class="fa-solid fa-key"></i> Change password
            </button>
            <!-- Modal -->
            <div class="modal fade" id="changePassword" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
              aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                  <div class="modal-header border-bottom-0">
                    <h5 class="modal-title" id="exampleModalLabel">Change password</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <form action="/user/change-password" method="post">
                    <div class="modal-body">
                      <div class="form-group">
                        <input type="text" class="form-control" id="" value="<%=loginUser.emailLogin%>" name="email"
                          hidden />
                      </div>

                      <div class="form-group">
                        <label for="">Enter Your Current Password</label>
                        <input type="password" class="form-control" id="" placeholder="Old Password"
                          name="currentPassword" required />
                      </div>

                      <div class="form-group">
                        <label for="">Enter Your New Password</label>
                        <input type="password" class="form-control" id="" placeholder="New Password" name="newPassword"
                          required />
                      </div>

                      <div class="form-group">
                        <label for="">Enter Your New Password Again</label>
                        <input type="password" class="form-control" id="" placeholder="Re-enter New Password"
                          name="newPasswordAgain" required />
                      </div>
                    </div>
                    <div class="modal-footer border-top-0 d-flex justify-content-center">
                      <button type="submit" class="btn btn-success">Commit Change</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
      <div class="col-xl-8">
        <!-- Account details card-->
        <div class="card mb-4">
          <div class="card-header">Account Details</div>
          <div class="card-body">

            <!-- Form Group (username)-->
            <div class="mb-3">
              <label class="small mb-1" for="inputUsername">Username (how your name will appear to other users on the
                site)</label>
              <!-- <input class="form-control" id="inputUsername" type="text" placeholder="Enter your username" value="username"> -->
              <input class="form-control" readonly id="userEmail_<%= userData.email %>" type="text"
                placeholder="UserName" value="<%= userData.email %>">
              <!-- <td class="edit" contenteditable="false" id="userEmail_<%= userData.email %>">
                              <%= userData.email %>
                            </td> -->
            </div>
            <!-- Form Row-->
            <div class="row gx-3 mb-3">
              <!-- Form Group (first name)-->
              <div class="col-md-6">
                <label class="small mb-1" for="inputFirstName">First name</label>
                <input class="form-control" id="userFirstName_<%= userData.email %>" type="text"
                  placeholder="Enter your first name" value="<%= userData.firstName %>">
              </div>
              <!-- Form Group (last name)-->
              <div class="col-md-6">
                <label class="small mb-1" for="inputLastName">Last name</label>
                <input class="form-control" id="userLastName_<%= userData.email %>" type="text"
                  placeholder="Enter your last name" value="<%= userData.lastName %>">
              </div>
            </div>
            <!-- Form Row        -->
            <!-- Form Group (email address)-->
            <div class="mb-3">
              <label class="small mb-1" for="inputEmailAddress">Address</label>
              <input class="form-control" id="userAddress_<%= userData.email %>" type="text"
                placeholder="Enter your address" value="<%= userData.address %>">
            </div>
            <!-- Form Row-->
            <div class="row gx-3 mb-3">
              <!-- Form Group (phone number)-->
              <div class="col-md-6">
                <label class="small mb-1" for="inputPhone">Phone number</label>
                <input class="form-control" id="userPhoneNumber_<%= userData.email %>" type="tel"
                  placeholder="Enter your phone number" value="<%= userData.phoneNumber %>">
              </div>
              <!-- Form Group (birthday)-->
              <div class="col-md-6">
                <label class="small mb-1" for="inputBirthday">Is Admin</label>
                <input class="form-control" readonly id="userIsAdmin_<%= userData.email %>" type="text" name="birthday"
                  placeholder="Is Admin" value="<%= userData.isAdmin %>">
              </div>
            </div>
            <!-- Save changes button-->
            <!-- <button class="btn btn-primary" type="button">Save changes</button> -->
            <button class="btn btn-success btn-save" id="saveBtn_<%=userData.email%>">
              Save change
            </button>


          </div>
        </div>
      </div>
    </div>
  </div>

  <%}); %>
</div>

<script src="/js/editUser1.js"></script>
<% } %>

<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
  integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
  integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

<%- include('partials/footer'); -%>